<view class="container">
  <!-- 页面标题 -->
  <view class="header">
    <view class="title">我的上传</view>
    <view class="subtitle">管理您上传的乐谱文件</view>
  </view>
  
  <!-- 上传进度显示 -->
  <view wx:if="{{showUploadProgress}}" class="upload-progress-container">
    <view class="upload-progress-content">
      <view class="upload-progress-title">{{currentUploadingScore.name || '正在上传文件...'}}</view>
      <view class="upload-progress-bar-container">
        <view class="upload-progress-bar" style="width: {{uploadProgress}}%;"></view>
      </view>
      <view class="upload-progress-text">{{uploadProgressText}}</view>
    </view>
  </view>

  <!-- 上传按钮 -->
  <view class="upload-section">
    <button class="upload-btn" bindtap="chooseAndUpload" data-uploadtype="file">
      <view class="upload-icon">📁</view>
      <view class="upload-text">选择文件</view>
    </button>
    <view class="upload-tip">上传文件谱，支持 PDF、JPG和PNG</view>
    <button class="upload-btn" bindtap="chooseAndUpload" data-uploadtype="je">
      <view class="upload-icon">🎹</view>
      <view class="upload-text">编辑JE谱</view>
    </button>
    <view class="upload-tip">上传JE谱，如(123)123[123]</view>
  </view>

  <!-- 乐谱列表 -->
  <view class="scores-section">
    <view class="section-header">
      <view class="section-title">已上传乐谱</view>
      <view class="score-count">共 {{scoresList.length}} 个文件</view>
    </view>

    <!-- 空状态 -->
    <view wx:if="{{scoresList.length === 0}}" class="empty-state">
      <view class="empty-icon">📄</view>
      <view class="empty-text">暂无上传的乐谱</view>
      <view class="empty-desc">点击上方按钮开始上传您的第一个乐谱吧</view>
    </view>

    <!-- 乐谱列表 -->
    <view wx:else class="scores-list">
      <view class="score-item" wx:for="{{scoresList}}" wx:key="id" bindtap="viewScore" data-score="{{item}}">
        <view class="score-preview">
          <view wx:if="{{item.type === 'pdf' || item.type === 'image'}}" class="preview-icon">📄</view>
          <view wx:elif="{{item.type === 'je'}}" class="preview-icon">🎹</view>
        </view>
        <view class="score-info">
          <view class="score-name">{{item.name}}</view>
          <view class="score-meta">
            <view class="score-size">{{item.sizeText}}</view>
            <view class="score-date">{{item.uploadDate}}</view>
          </view>
        </view>
        <view class="score-actions">
          <view class="action-btn" bindtap="deleteScore" data-id="{{item.id}}" catchtap>
            <view class="action-icon">🗑️</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
